---
date: 2021-04-09 15:28:00
updated: 2021-04-09 15:28:00
mathjax: true
typora-root-url: ../..
---



# 这个服务器很便宜

[链接](https://buy.cloud.tencent.com/lighthouse?buy_from=lh-console)

![image-2021-04-09 15.29.27.440](/images/image-2021-04-09-15.29.27.440.png)



就是内存比较小，目前我使用这个云服务器搭建了vpn和我的blog主站点。

<!-- more -->

```shell
[root@VM-4-4-centos swap]# docker ps -a
CONTAINER ID   IMAGE                       COMMAND                  CREATED          STATUS          PORTS                                        NAMES
264e6aaffa7a   mysql                       "docker-entrypoint.s…"   29 minutes ago   Up 13 minutes   0.0.0.0:3306->3306/tcp, 33060/tcp            mysql
b6714f9102f8   nginx                       "/docker-entrypoint.…"   3 weeks ago      Up 13 minutes   0.0.0.0:80->80/tcp                           hexo-blog
a3845de540c9   imhang/shadowsocks-docker   "/bin/sh -c 'ss-serv…"   3 weeks ago      Up 13 minutes   0.0.0.0:443->443/tcp, 0.0.0.0:443->443/udp   vpn
```

由于要开始进行毕设，所以我又开启了一个mysql服务。然后死机了。

估计是由于内存较小，导致机器容易死机，所以进行了排查。最后发现他没有使用交换空间。

```free
[root@VM-4-4-centos swap]# free
              total        used        free      shared  buff/cache   available
Mem:         841236      586396       89428         372      165412      129820
Swap:             0           0           0
```

我们考虑使用swap空间

```shell
cd /data
mkdir swap
cd swap
# 我们使用2G的交换空间
dd if=/dev/zero of=swapfile bs=1M count=2048
mkswap swapfile
swapon swapfile
```

```shell
[root@VM-4-4-centos swap]# free -h
              total        used        free      shared  buff/cache   available
Mem:          821Mi       576Mi        77Mi       0.0Ki       168Mi       122Mi
Swap:         2.0Gi        20Mi       2.0Gi
```

这用了跟没用一样

我们查看swap的内核参数

```shell
[root@VM-4-4-centos swap]# sysctl -a | grep vm.swappiness
vm.swappiness = 30
```

按照这个修改（可惜还是没效果）

https://yangxx.net/?p=1236

但是奇怪的是mysql以及可以运行了，那不管了，能跑就行。